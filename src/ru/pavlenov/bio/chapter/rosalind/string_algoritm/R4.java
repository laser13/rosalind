package ru.pavlenov.bio.chapter.rosalind.string_algoritm;

import net.sf.jfasta.FASTAElement;
import net.sf.jfasta.impl.FASTAElementIterator;
import net.sf.jfasta.impl.FASTAFileReaderImpl;
import net.sf.kerner.utils.io.UtilIO;
import ru.pavlenov.bio.genome.DNA;
import ru.pavlenov.bio.utils.Dump;

import java.io.IOException;
import java.io.StringReader;

/**
 * Какой сам ☭
 * User: Павленов Семён
 * Date: 28.12.13 10:56
 */
public class R4 {

    /**
     * Computing GC Content
     * http://rosalind.info/problems/gc/
     *
     * @throws IOException
     */
    public static void start() throws IOException {

        String data = ">Rosalind_4227\n" +
                "AGGGCCCCAAGACGGGGGAAGCACTGTTGATACGAGAGCTGACATTCAACTGAAGTTCAC\n" +
                "CGATAGTGGAGTCTGTATCCGGGCCGGACGATTTCAACTAATTAGGGAAAGCATATATCT\n" +
                "ATTTCCAGGTCCAGTCGACCAACACTTACGCTTGGCGAATTTGCTACATGTCACATTTCG\n" +
                "CTAGCTTTGACTTGAAAGCAGCCTCTCGCATAATGTGATACACTGAACCCAGATTCCCCC\n" +
                "TTTAAACAAAGGGGGGATTCCTAGTCGAATGTGGGCCCGTCGTAGGAGAAGCTAAGGCAC\n" +
                "ACGTCCGTTTCACAAGTCTTAGCATTGCTTTCTCACATAGGCCTCGATGGGTCAGTGGAA\n" +
                "TTGCATCTGTTGAATGTCATGAAACGCTCTACATTAGGATGTGTGGGAAATGAATCATTG\n" +
                "CCTCATCTGGGGTTGAACCCATTAGGCAAGGCTCATACGACCCCTATTCCGCTTTAAGCT\n" +
                "CTGCGCTACAAGTTCAACGTCTAGCCACAAACTGTTGTCCTATCCGGCTTCAGTATGGTT\n" +
                "ATTAGAGTCCCCGTCCTTTGCCTTAAGGTTTTCTCGTTGGCAAAGTCGGATGGTCACAAT\n" +
                "TTACTGCCGTGCGGCAAGAGACCACCACTTAGTAATATTCATAGAAAACTGAATCTAGCC\n" +
                "CAGACGCTGTCTGGCCATCACCACGTCGAGGTCTACACGCAAGTTTGATTGTGTCTCACG\n" +
                "AAAGCGGGGGATCCACCTTGATGATCACCATGGTCAGCTATGGCCGAAGGACATTACACC\n" +
                "CAGCCGCATTGTACCGATCAAGCCCCGCATAGTGGAATCCCATAGCATCAATAAAAATAT\n" +
                "GGAGCATGGGGACG\n" +
                ">Rosalind_6024\n" +
                "CTAGAGGAACTAATGAAATACTGGGATGGCGAAAGTCGCATGGCTATAGCTATCTGACCG\n" +
                "CCCGGATCTCGAGGGACCGTACGGGCGGTTTGATATGTTTGCGCGCAGGCCGCACACCGT\n" +
                "CGTGGACAAAGGTTTGTTAAACCGTTCGTCTCACGTATTTCAATTCCCCCCTATGTGCCA\n" +
                "GACTCTAAAGAACTAACTCAGATTGACGCGTATCTGCGTTCTCACACGTATCGTTTCAAA\n" +
                "CTCCGCCGTGGCGTAAAGTAAGCATGATCCAGGTGCATAAACCGCAGTCTTCAGAAAGTA\n" +
                "GCTAAGTAATACTGAGCGCTCTGCAAAATTACAACGATCATAACGGAATGATCTGGTCGA\n" +
                "CATAGCCCAAGCTGTCGGATAAGCTATCACGCTCCTTCACAGTATGAAGTAGCCCGCGTC\n" +
                "AGATTCTGAGTCCTAGTATCGCGTTACCGTGATAATTAGGCCATTCACTACATAGGAAAC\n" +
                "ACCCATTAGATCGGCTACGACGTTCTTTAGCGAGACCGGGCATGTTGTAAGAATGGGTCA\n" +
                "ATCAGCTCTTTTTCGGGGGGTTTCTCGAAGCATAGCGCGTAAGTCTGCTGATTGGTCCCT\n" +
                "AGCGAGATGGAATTTACGAGTGTGATTCCTGTTCTACTGGCTCCTCCTGTAGACTGCGTC\n" +
                "CGTGCACTATCTCTGTCCCGACTAGGCCGCATCCATCTGATCGAGACTTTGGACCGTACC\n" +
                "GCGCTGAGCATTATGTGCAGATCCCTTTAGAAACAAGTTTGCTAATTTGTTAGTAATAAC\n" +
                "TGCATGTCTAGTCGCCAAGCTCCGAAATCCTACTGATCATTAAGGGGGGTTTATTATATA\n" +
                "TCACCTTGAGACGGACAGCACTATGCTTAAGACATGGTGACAGTTGACGGCGAGCAAAGT\n" +
                "CGGGATACACACAACGAGGTAATAGTCAGAACATCTTGAATTAATGGAGAGACGACACTA\n" +
                "GTCTTAGTCTGAACTTCGTCGAG\n" +
                ">Rosalind_9220\n" +
                "CACAGGCTTGCGCTTGTCTCAGGAGCAGTTACCCTGATTACAGCTCGGGGGGACTGCCAA\n" +
                "GAGAGCTCTCAACAGCCCATTTGGTCAATCCAGATTTCGGTGTCCGCGTCGATATCCACG\n" +
                "TCATACCTACGGATCTTATTCTCTACCGAGGTCTACTGATCCTCCTTTTTCACCAGCTTG\n" +
                "GCAAATCCGATTCGTTACACGTGGGTTAACCGTACGATACTAATTGACTGGTGCAACTTT\n" +
                "TGTACCATGATTATCTAAGAGTGTACTGCGTCGGCGAACGCATTTATGCCTCGGGGTACG\n" +
                "GCTGTCGCTAAAATCCGCATCATTCCTACATCACATGTAGAACGAACACGACATGTGTAC\n" +
                "TCAGCTCGTTTGTGGGTCTTAGCTGACCTTGAAAATTAACGCTCATGAATGGACTCTCTC\n" +
                "TCGGTTTTTGCGACTAACGAGATACTTGCGGGGAAGTCGAGACACACTGTACGCTAACGG\n" +
                "CCGACCGAAAACGCAACCTCGTAAGTTCTTTTCTTTACTAGGATCGAAGTTCTTTTGTTA\n" +
                "GCCACGGAGAGGAGCGAGCGTTCACCCCTAGCACTCGGCCAATTTCTAAATTACGCTAAT\n" +
                "CGACGGATGAGGATCGGATTTGACAGTCAGTCACCTTGTCCTCTGTGTAACTAATGCCAC\n" +
                "TTGGCACGGACGTGTCCTTTAGCATACCTAAGATATCATTAACATTTGGATTATAGACCT\n" +
                "GTCCTCACACCGTGGTTGGTCTAAGGGTATCCCGAGCCGCCATTCTATTCCGAATTCCGA\n" +
                "GACTCAGAGGTACTACCGCGCAAGACAATTCGCGTAAGAACGTACTTGCGACTAGCGACA\n" +
                "TACTTGTTGGCGGTGAGTTGATCTAGGCTCTATAATG\n" +
                ">Rosalind_2545\n" +
                "GATAGCAGTGGGCCGTTAGCCGGCCGTAAATAGTCTCACTCATGAGTTTAGTCTAGATCT\n" +
                "ATTTACACCTTAGTTTAAGTATGGGGGGTTCGGGTACGCCGACATTGTCTGTTTCCTAAG\n" +
                "ATAACTTTTGATTCAGTAATGTCCAATGCTCGCGGGATGGTATACCCCCGTTCATAGCTC\n" +
                "TACGCGAACTTAGCAAACCGCCGCTGGGCGCTTTCTCGGCTATGATTACCGGTAAATGAA\n" +
                "CACTTAGCACAATTATTTAGCAAATTACGAACTTGTAACGCACGATTAATCCTATTACCG\n" +
                "ATTTTGGTCAGCCGGAACTGCGGTAAAGGTGTGGGAGCTGCACCACCATAGCCTCCCATT\n" +
                "TCGTATGAACTTCGGTGGCCCCCGGATCGTCCTTATAGGTCCTTTCTAACTCAATCCTTG\n" +
                "ACATTCGATTTGTACACATTTCGGGTTGGTATGGGGGGACTCTAATAGAGTGTTAGAGGA\n" +
                "ATAACGCGATGTATACACCTGCATCGAATCCCGATTCTATGGCCTAGAAAGGCCATGATT\n" +
                "CAAGCATAGGATTGTCTTCTCGCTATGAGGCCTCTCACGCGAACCCCTTTGGCGCCCCGC\n" +
                "TGCGTTTGTGCGGGAATTACGCTCTATACTGGCGTCAAATGTCACTGGTAGGATGACAAG\n" +
                "GTAGCGGACTGATAACCGACTGTGCTTAGGTGCCAACCGCCCGTGGGGCCTAGTGCTAAA\n" +
                "AACGGCGCCGCATGACCGTCCGGTACAAGGTAGGGGTTACAAACCCTTGTTGCCAGCTGT\n" +
                "AACAACACCAAAGCGGGTTTTACTGATGAACGACATATTTCGATCGGCGAGTAGGTAGCG\n" +
                "CACTCCTCCAAGTCAATCAATAACTTTACTTACCTTATTACGATCCAGATAATATTTATT\n" +
                "TTCCCCTCACATACAAGGGCCACCCACGATCACCCAATGCTGGATGCTGTAATATCGAGG\n" +
                "GAG\n" +
                ">Rosalind_6574\n" +
                "TCGTAAGGCCGTAGGCCTCTTAACTGCTATTCCTACATAAGACGGCTCTTTATTTTTCAA\n" +
                "AAGCGTGGATACTAACACATACCTTGACTCATTCCGGGAGCGTCACTCCTATTTAAACTT\n" +
                "GCAGAAACGAGCTCGGGCTGGATCATCTTTAGCTCGTACTTTAACGCAGCCAATATTGGA\n" +
                "CAGGTTGCCTCATGTTGAGTCGTGAGATGTGGGGCTGTTTTTGGTGAAGTGCGAATGAGG\n" +
                "ACGGTCTACCTCACAGAACGTTCCCTTTTCGAATAAGCCGATGCCGAACTGTACACATTG\n" +
                "CGCCGGGTTAGACGCGATATTATGTGAGGCCGCCGCGCCAGTCTGCCAATCACCCGGAGC\n" +
                "AACCACATTAAGCGGGCTGCGCCAACCGCCGATTCGGGCATCTGCCCCCCACATCTTGAT\n" +
                "AGCTTGGGTTATGAGCCCCAGTCAAGCTAGAGAGCGTCGCTTGAATTCTTCACCCCTATG\n" +
                "GGAGACGGCATGAACAAAGAATGGTAAAGGCTACGATAGGGCTCTAAAAGCAAAGCAATT\n" +
                "CCACAGAATCGTAGAGCTTTTTAAATCCATGGCCACGACGCCTAAGTCGCTTACCCGGAA\n" +
                "GGAGGATAGGCAACGATACCTAAAGCTAGCATTTCACGTAGGTTGACCTTTAAAAATCTC\n" +
                "GGGATACTTGAGCCGCATCCGTAGGCGAGCATGCCGACTGGGCTAATTGGTGACACATAT\n" +
                "AAGTTATAGTATCACTCTCAACCTTTCAGACACGAGTGCTCGTACTATGGGGATCGTGGG\n" +
                "TGCGCGCGGATCCCCAATCCCGATCCTTTTAGTATTTAGAAGCAAATAGGCAACATTTTA\n" +
                "ATTTAGTGCCCTCCTCGCTATTCGCGGCAATCTATGCTGTCGCGATCCGGCTTATACTAT\n" +
                "GCTCAAAGGGTCGCGT";

        final FASTAElementIterator it = new FASTAFileReaderImpl(new StringReader(data)).getIterator();

        float max = 0f;
        String header = "";

        while (it.hasNext()) {

            FASTAElement fasta = it.next();
            Dump.println(fasta.getHeader());

            DNA dna = new DNA(fasta.getSequence());

            int gc = dna.GCContent();

            float pr = gc * 100 / (float) fasta.getSequenceLength();

            if (pr > max) {
                max = pr;
                header = fasta.getHeader();
            }


        }

        Dump.println("---");
        Dump.println(header);
        Dump.println(max);


    }

}
