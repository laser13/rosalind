package ru.pavlenov.bio.chapter.stepic;

import org.apache.commons.lang.StringUtils;
import ru.pavlenov.bio.amino.GlobalAlignment;
import ru.pavlenov.bio.amino.InvalidAlphabetException;
import ru.pavlenov.bio.utils.Dump;

import java.util.ArrayList;

/**
 * Какой сам ⚝
 * Author: Pavlenov Semen
 * Date: 23.12.13
 * <p>
 * E = mc^2
 */
public class C77_3 {

    public static void start() throws InvalidAlphabetException {

        int σ = 1;

        String str2 = "CQCPPWARSKPWNESKEWGCCHRWNPFMEFGCCPWADCDTTNKEVPERFLQRDIPVMICKWCTMIDLFGKSTTEAWPDWWKLIQQFYKANIGMWFWTCAIVQESGRAFVGCFGRNLNYKDFSFQNMFEWHDEHAHPHQHKMKQYARFHNEDPSFKRYAWFWSRYPDIHGHGFDKHYIDWAAGYIQGPREENNCMGWCYDHATNEAYCAKLWHAIIVVSTMVIEGYYNPSGARSWYRFMKDDTKFQHEQQMETKWEDAHSIQICLYTYFVRDFDIQFNVCVKESFTLQDCHWSRTEWFKACKYASMECETVKHRNFHANYSWWVAGSHIKYLFPALGIYIIGACCIRGCCLDGKKSINPLHVKANYTYQWYAPKPFHIYRVQQERAVMMHMGEAPHAVMCARKRWKLYLQFLVCNHMVWPIIITEPHEDHNMTYSGCSWFKEPEVGPSLPCAVCAMQHVLKTQWFQTQWYMHASLSLCAKLELANHMAISFVLLRRGFKGCHNQPHAEQHLKMKLFSFEPIMEDEYNDQHAEHQNGKQQGQMCTQAHRIEEQYTSIKAKAKDCQVWDIEPTANWELHLGPLYGPQYSVPNAESEDSKRYYLIANPYDIAGSYYDTCDDNCFLMAGRKQMVIQDRIRIYLRNKMLLRAFLYHKKCHNIQDCYQYKPLYCQEMNWVGWDFVKNEFPHYCYADRYNCQKISSAHQFYANWFCRMMKIVPFGCSCNHWDVENGQYAHYECWARSLPKCNFPSRPDVFDST";
        String str1 = "CECPPWALSKPWNESKEWGCAAQQELGIHKWNWHDICGFMEFPMCPWADCDFKEVPERFLQRDIVIMNCTCCKWCTMIDLFTKSTLECWWKKAWEVSGKRNNIGMRLKRSKSGVFWTCAIVQEEGRAFVGCFGFNTNYKDFFYQNMKEWNTTTRMHAAPDQHKHYNSDCNQEDADIHGHGFDKHYIDWAACYIQNCMGWCQAYCAKLWHAWGTDSTMVIMGYYNPTKFQHEQQMETKWEDEHEYSIQSCLYCVKESFTGQDCHWSRTEKMECETVKHRNFHANYSWYLFPCCMGVKSINPLHVKTCHYDYDNYLYQWYAEKPFHIQQEAVMMEFGYMHMGEAHHAVMCALLFWDCVCNPHGVWPIIITEPHEHHNMTYSDCSPLSLPCAVCQMQHVKKTQPFQTQRYMHADLCAKAITLGELGDHFVLLRRGFKGCHLEMICWTNEWRTAPPHAEQHLKMKLFSFEAIMEDEYNKRANGQRAEHQNGKQQGQMCTQAHRITSKPKVWDPEPTANRELHLDGPLYGPQYGVYNAYWDPHIQVMTAGSYCMCTCDDNHFLMAGRKQMRIQDRQWVTGMRILLPNKMFLRAFLYHKACAGNIQDCYWPSYKPLYCQEMNWVGWQFVKNAFMKIHYCQADQYNCQKCQLSLRWCPNWFCRLMKIVPFGFYNVQTDPEPECNHWDVLPKCNFPHRPDVFDST";

        Dump.println(str1.toCharArray());
        Dump.println(str2.toCharArray());

        GlobalAlignment globalAlignment = new GlobalAlignment(str1, str2);
        globalAlignment.setPenalty(σ);

        globalAlignment.make();

//        Dump.println(str1.toCharArray());
//        Dump.println(str2.toCharArray());
//        Dump.println(globalAlignment.getTrackMatrix());
//        Dump.println(globalAlignment.getWeightMatrix());

        globalAlignment.track(str1.length()-1, str2.length()-1);


        ArrayList<Character> result1 = globalAlignment.getResult1();
        ArrayList<Character> result2 = globalAlignment.getResult2();

        Dump.println(StringUtils.join(result1, ""));
        Dump.println(StringUtils.join(result2, ""));

        int min = 0;
        for (int i = 0; i < result1.size(); i++) {
            if (result1.get(i) != result2.get(i)) {
                min++;
            }
        }


        Dump.println(min);


    }

}
