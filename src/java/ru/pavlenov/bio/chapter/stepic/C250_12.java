package ru.pavlenov.bio.chapter.stepic;

import org.apache.commons.lang.StringUtils;
import ru.pavlenov.bio.amino.GlobalAlignment;
import ru.pavlenov.bio.amino.InvalidAlphabetException;
import ru.pavlenov.bio.amino.LinearSpaceAlignment;
import ru.pavlenov.bio.amino.Move;
import ru.pavlenov.bio.utils.Dump;

/**
 * Какой сам ☭
 * User: Павленов Семён
 * Date: 04.01.14 18:49
 */
public class C250_12 {

    public static void start() throws InvalidAlphabetException {

        String str1 = "QINDYYELTHANYWGMPCWINIICPVLEVSGRGMAGYFGWVVPRGAMRPTYCRAWVKSEQHWTPRHLWFPAAIQDRINMAMEDWWVEAQPGFSEFWKDFWPPNFPEQMCIWNTRTIVHRIHHNSNDFGKEMYYLVYNNCFIINLMMNRQHVCFVMIFMCNSMRINWVLTRARIGFTFTLGQCENSSSRQYDTPYYPPLCCCIICLSFPAQCRKSRDIMWHMQQPDNEEPGSMQGNQEPTCQKQQIMANNMLAIEIATCPNMKEYPDYMFGCWICVKYSRIVWPCKAKWLPMGITRDWSAGTCRHMYQHYSYGHCKHKNRMQGYRYDNCTVAFQHWNQSQAGGRPCMHLIPSWKPRDADACCNSLKRHLVWGHYMNHLGELQLAPQKLAVCIKMYVACIEAHWSYKCHMPERWQSVVMTSERTLKFNQLELKKDRSFTCAYGRTDLCHCSSWPLLLFEIDIPRNYIWTAHDTYKNQNPGKCNNNQCHCWSHYAEEKVAAIAWPSLVFNMASGFHNTKELSTHCKLDIVKMGCDNKGTDHVAFVRFFHQKDSELPEYDTWHCHCSFPFGQHKKIHTIQRCEKATHITRHVVGYRKPCWGGYGAVQFIQPITLQSNICCANFWQGIRIRQADKWKEYRVVGAQLSAPCFFEINHDHVKQPQWKGCGTLEVIHSVMPRAYCTTTGEFKVQVSIVFIFQMNAHLGICPYCFPNPKNIGRMKCYAKKHNCQIKNEIRHTMHVIDMKVAYAQLKDCSSHQCLMTQFQKAISLAVPDEQDLQQANITATPPWCPPNIEYQEQCYGKASRHLWGNMGHHCKWGQYCAFNGAFHKGVTDGEWWQMAEYLDCQNNESSNSWTVIEWPNGADYLKHQQVSTRVVHISLSIEMKGEKICGYQCDLAYTMYHLNSIPFGDLISMFVIQHWIPDCSFAERRFWVMEIGAHQPMRILIKYHSAKCLPYGKPQRINCWNYPIIYRSMAMMHARCNVICPHNRSVAQYQAGIMTVAISQSEFITYSFNTTWDEYYNFAYKWLYARTQCWVRNCRHWDHYMNEYEQMQATMPRPSHIRNMDYDEQNMTDVWGHMPAGNRGREKHPRTAGITCKHLLGALDFMSWCKTNKLEHEDVHGTYNSQRRPLMILGRGMYSVIAYPADYSIWPRNNDWGDSYKEWADNRQIVDCMSFDSMGDDAVMDTASARRIWCACDGYCSDQEQVQEIIVHCCIVNVGQHFLFCYQECHTYSISGDVIETMCSKDCADELGQWIWAVMFVDVNAPGNYKVHLKQNVLLINYMKIHKKRKEQQIAPFTKPPCTNTGNNWIDNKIHRMVNIDPEKCKKWTNQKPRWHRCTWINDLHRETVECGVAYHEDDWCHFDTWRPWAHTKRLPKDYHRAELSDNRFNIALWIGVKNGTTWHDDYFNGFADLTSNWFTCQHQQSTHCFTNGCEVVWWPRSFRVIHPQENPRWDEVILYLRMFPVIDSYCFLKLIPSPWEYDARDITRAYLRNYKNCRHDMVWVFMVPTNQFMWHPFVVWSCMGAYFQHVVYQGCPLIYQLIIAHCSQCALWNAKFGMGFVFTARWDFHLMWPWVLSELWQLNTAKQLTEHDNPDWCVMRTDTKLFNYIDNTMLVECVWRDNLCACKCVCVFGITHTCSIWTPVEWCLQKMNDSEHKVHSVDLYPWDKCVPMQDPRYKNEIKCEQMNECEIMLELTRNQMMLTCKPYNAADSPESWRCYGQFNVEADPQFRCEPTYIPECRIDHCHTPAPHMNAEQHHHSSTPALHWHHKCVKQVSKVGDWINQFPFPNEGFDGFLKVDHNIVPYHIVIHICKEFVVLARSGRCHAKWASWRYCWPMYGPVIVAGNHPDNFRKNHKTFVDFSAQMAYNHTSWFVCWPEWTHKCYLESPELLGKSWPEFQDHWFLRFLRYQQHNSMGSVHEWETEETQPYFFPNWFFKCRIAQSSPAIIQDECVTIVLWMNFTYMCQMKYKVCWDCMQVGGEIQPQWMEIYMYRKNRTWPLHIVLVYKKEIMTQKVVFHYDLDHRAWESAKGVGGALMMDCFHVVAQTSCMWWFKCYMIIMFPRKVESEDASINTEGMGCWHRYDRQLFQDMHNLCYLEALFDNWAECPVTWMKVDGKLIIQYRSLSITRIIKHLLVDRTWKRCCWNPCITPCQMQLSGSDGIPINVTLVFGHSDMPHVFSWAPIQYENPEDHRYQSFESQWNTYVVVNGYVYFKEHKRNNKERGIWMHYHHQLGSSWTYGKDKYECAKWWNTDMWMNGQGHPCQCGFCNIHLVRFWRCFYDCNQVWTFQFPCNRFMFERLLNEQLALTQYTEFISYPSRYCRKNKNKSIQLVMYGANFEMPKQRDWMMMCREDDHSCLRCHEFPYMSFKIWISYYSYGSPWTMWVHAAEWAMYQGCMDFEQDQQKPFTKFHLQDDTHVLGPMYIKQILGDWEGKEVHGHKVIYEEDHRTLVFTMQDKHDKRSVFLALIKKIDSRFVQQWLTICFYSGIWGMVTLADNQVMMFPHYTNNICEQIYCKHLNRRMNEIAWHCGRWEMSPVLYACCHMLCTYCWIKTYAVKDTNFNGNCAKKERCAKFYKTITEKGLTILSNGLHPMPNDRNPRRFYTVVVVNFQRSSCERHDRLSRSGLPMINPMMVMGGNERYYRMENWMKLWSERVDNSCPPFHLMYYEYAVWQNCAYPETKRGKLGLCRGFEHNLDELARKAKTKCARLGFVYYHMIDCESTSQEKRFTGQRVFCIFLQYVNTLMTEDWLIMAHHDRMAGLLPLYEMCLLINRAPSNAFGDQDIPLSDAPIIGRDPSYNSVRTSRYYMMNAIAFKVQHMNINDDSDLIWYNVWYKKDQEICHVNEVHYCTERYCECYSSFGNTRYGQIMKCTYLAFDGHVCMCCKQGYGRIKEFGWILQANRMGGIAFHQDTMWEIMDYDNMHKMFSEPDIGLPGRGNPDQSVTISPFKHPAADIYQMMHYVMSQVYYSQHLDFCHQVQWVYEHAHEWPLPAHETDWCIPMTTEHFASPFQTTDSWGCYHAQDFQTILRKCTCCWCRRTNWCWYNRCAASDKMTVITDTAIFIFVWSCTNYPPTQFECMMGFNGHTIWLVCSKLSITGQDDPIRTFMSIQHMPAHIMWIIKYIYSGMAMKDHIFGQCLFRNHFKIQKSYHEFYCCFMLNMFDCWRVFVKYAPDIRRYEHGWCMSIDLHAHQTYVVADCNKDLHRIRGATQHEHYRTDKKQHWHNPREYWAGFKETDERGCYDRHHAVCFIQMNADPDTKMTPQKAEMSDSSCQKICQPDWATANANLTGYCCRHACNLYGKSFFFTRNPFKCRLQCKFADYSPSSNAHHTCCDWPDMNHAPQGKPRDKNTEIMVILFRYCFIQSSHEYNPQCCKWGQWCIMQEKWIEDHYLDWCKEKGRAYEYVAPIMYHSSHVYMGAVYIWYKYMFHWIMWKQASSFGPHRCFILFLVTIKKKPLHWQHNPMHRRGVQNHPVQPKQHTGIDVQWPPRWLLNVGRDGHYILARIYHDKMVLSYPEWQFYEIKPHCTVENFATEEYFRPAPMVQEQINPYWYQCHVQAFLKQEEPHGWNTDMNCVMQQLWEGTPHTWAMIGHGAFVPWFFRRYMQAENAICNYVVRFKQFSGLFEICNSYDETCGKKSFMMSCYIHGQNAQAVRTGRNKFAYSFNKDKKCWMDTVKVCRWSKGNNDRDRCRKMVWTEEHPPIPKISKDKVESCEDYQSFGLTHEVLPVYAESRALFRQWTGGDTKWNKKHRVDHFMCYHIGAWSFPCDEFVAGGKAKVEYMDACRATLDLSVLRFYLEMCYDPDYVCSNMHECGFFPSQICRIEEYLINLKPMFTINPPLQSQSQQFSRKTGWLKGFCRNRSKSMVQRVAMDSLSYIFGHFSCCNDWYIIECHDFWKFDARWHLNQKHLGWNNRDMFDFDRGIMYYTATALVDGRGMRGAVAWLLRDPQGHSAKDVDTTLKYRNSKVDVFLMHSHHSEAQDKFKQTFQALLHCFFSVCWGSGIITYLRPVQTAEWWELCQFHKSCMRCVMFIPHVFKNVWALPIMMYILGNVM";
        String str2 = "PCTGVWWVTKTMKAMDFHRTEDPTVAWYCCHMNCAWFNAAYPGIMHTWYFQHMLWQQPWSMSRMVAVEYINKRTCPESELKYYSECTLDCPQEPCGKSDAQVHDFAERATFISWTPQPPRSFGEVLDAVSYALVFSDMVVQGTYQEWMDGMADIINGCDRAYTMWFQKRHSLPPHMGAATHIWVIFDYCAKFHITKELNWWTRNPWDCFRDYQQFEIWGAKPTCKRQKMCMDWSVCQIDWYNCINGWGSPEKIRISFAKWPDVMHIGMHEYCKLFGVLTNYDLIAERWRWVECNHKTGIMHHMIYPRHKVHERGLEWDCLLKRQIESQTWIRAPWWFMTVWSTKNSDVWSFRPDTFYNDVLHCGHDKHWGKVGMMHWYSKPRWYLAKGFAVGMWVRTRNCVNIHDALAPQSWVKENWFMFLLHWVISNQAWSHDMWARRYPMWRHFSAVLPDLRFWTLIKQQTPVSEEGIRHTKGKMRCDPWEWSGKMCLPYFMRHPHHRSYWQRYPPQFGGYCWEIKEWAHNPDTQWITVGFDLYTLFRFNMDYCLGPGTPDPRNFPVDGMNFMFAAFHVGTDKCGKNWYKHNVCAYDCDQCWLICAATPGWALCNLWIRPKHPNYFTNNLDNGLLNMWYIIVILIHHIEEKPSHSNRSCKWEKYTQKHFAYLMWHTFRRQQEPFHMPTVCWYRFKDDEKNHHQYVPFHAQNCTEITIMQCHRPLGRTVMWDKWRKVHFTPEAGMTREIDLDHFCSLFVLGQFKHQGVRIGQKHIYKYKTEELQTEAFGWSYFEFEFMGNPNGIEVDLEGKHKMVQVQAWRVWRDMPREPFQLQHLEWWRKWTIVNHSLRPWCMTCYKGHTGGNKHQMDNNFTYSEEHHSKWNNKCKAAINMPIDTPHAQFNDMAIKSTKVDWQQLTFTCRIASEYDYAVDIRCSASLKLFGRSLAPVGSANWYARMSKCECTQELLFMGNETHSNHSKFVMWMTLSMVYNIRCLDLYFAQRWNPHQTIRMWNAGSDMNDMGFCMTFCVKSSMCWQCMPDTCQQPHQLCEKMCIHLKFWFTAVFKPQSCQIDMAMDWQWDKICHKNVLAQMTSQDFMVVEGDDHLWWVQRYFACGFLYWTFLPMPSEWRGIWQPKCWNRCCCLKASDCWFTMPGMITKMIGEDFVRCLMYHMYKIYSTFIESCIPEPKWPMQSMAMCITNGVCNCRKRDCEWTSKPNHLKAMKHAQQPTRMHECGFFLGCFTWCSQQKTHITMWSGQNCNNKLYQFFIFKIWAANLIFVSVWQHAFEMHVFQCAKWRMYQSDKFQYDVKFFYPHCVDHFWAVNDFHGQGDFPLQLHQTDNMWEYMWVMKTIKIWGFMDAKLHDVWEVWKADSRSNSVNDRIAWLQNFVRMAHYCYPCEDVKHHVFWNQFMAQKPKKRKKWTCVSNQMMPGNIMNESMVDNYDDMPYGDIWEVYWLPMYALNNNSRLYMCHQGEHSVPEWEKKYRVSDFYMWDFLHWSWGREQCTSKMADSVDQSVWRAWVYSLEDMMNPLDWSHVVFHRMSMFCITWENNRMFVLKYGKEVQIINTKEGKHTCFTLVIHLFCCTTCSTVMYAKVSCGCKENTANEFHSVLPEVRIASPCEFPVRCWFPIVTHYKMAYFEYPCRPQGMNTQYTNYVAAVKHMRIAAPKTMTYYMYCALNQMRQKNTVPHCNGWDRRERNWNNDSRIEKHSYWENVDWQFRGAIMTDMFAQWSCEMKWCPGIHHTIPTCTLWWFAASMMERWAHQIAWMRLKYDKLKIYKPYMKQYDQSFRRCSHGKCFAKWRIRHENMDNVIVIHICKEFVVNYYRSGRCHAKWAEVWRYCWPVFETPDHKHHRNYDRPVIVAGNHPHKTFSAQMRMNFVCWPEWTHKCYLESPELLGKQDHWVQWNYCIVFLRYQQHNSKGSVHWETEETQPYFFPNWFFYCRIAQSSPQFPLYIQRECVTITLWMNFTYMCQMKYQGEIQPQWMEFYMYRKNRKLLRITRKKKEDEPMTQKLAFVINRNVFHYDQDHRAWERAEGDYGVGGALMMDCFHVVTRVTSCMWWFKCYMIGMLFFRGSEPPPKVESLDASINTEGMGCWHRYDRQLFQDMTCANLCFTEALFDNWAEVHYWTPVTWMKVPGSPGLIIQDRSLHRQWTCWIHTRIIFKPPVTMKLLVDWPFSKKNPCITPCQNVAESVLSGSNLELPINVTLVFGHMVFSWAPIQYENPEDRNQSFESQWNTYVVVNGYVYKKEEWHVEPSKRNNKERGIWMHYHHQWGQSWTYGKDKKECAKWWMAHPGSVECLFAVYIYMQKFPVGSTENLALHFCEYNCADRKYCCYPEFPGLGKHWEWYTNKGKERALNCKTPAIFVYHFADQSEFKIESCPSRTAKTEKDHEYLHGDMTKDNFHRMACMDVSHDKEFKANDWRERNDNDFPCKFMGMNDATFISAEQQMIKYDQMQHFAPRDPYVTYCMIYDEGAGWPMRWPYGSASYDVIELMKCNLPACCRWKSMGTKVSNMVLCNNPQSEMMTYDCSYLNFYNPLSPFWRIFMSAHHGHTKFESQWQYTNPCCDPGCWGMIREQNEAIFVFARIPCYVVPQKPVVSLLHMPHSLKAGLLLMWMNPSYYVLKNTRFGWLSNICQHWNYSPTRQSMGMYVFVWLVPGDWACTQRTYWTKLFNICPVDVSFIHEDNRSAICLFQGDHTIIWKPAEEYWYCQHQVPPYVMFYHIQLMACKWMMNQDPLVHYQISRTWCELKFCRWLWGRKSEVAHYISDPMSADDPMQYSAEKMYTTERWMYNRYGSYYTWPQLHFHNINESRNRPMVASVCPGAFYINTPFIIRHFFTRDRSGCVFQYRHLAREIMGYRQAWGMWNEDRHGFRYWNGPWQWQGEWCTIWWRADESQSDMMKRMIVCAEDDWNWQQFAWLQYHYKKILFQPFFKCGWGKGIYDREVIMSWPIHMQACTYLVECETHQPLMFQTHGTGCSGEAETRHYDPPPYLWHSESLEVVTWFPPFKHEPEMHPRNIYECYTYNTVPCSLIRISGYQGKNTHAIVHMETGNMVPILNDRGKEWHDLFVACLIATRKIKNCPFDAAFGRPLSWTEANVVRCACCSLSTQMSTAHSQWIHADAGRCIRFPWIGKRLYNWARMPVQINEAGTGWLDVIYSLNDVPTQLPPGMKCSMPRVGKSPRGRHYQIAPWIHEKMQWYSTVSKVQRYPQQFHATFLQMQDLLYTSFQCLAILPMGIDMEGKVEWASYFYCKCFVCTLPYKRMRGPTSKLDVKRDMQMHQPRVHFQEHCIVFKEACKTVFTRWNRVLILYYCREENERYDKYCVVAQYYRDPIGCGQKFNCNCNHQCMITYQGWENVCPFAWWPHEISQQNFYCISFFLFINKVHEMHDSLDVINWPQGDMLDVVYEIKHNCCMMFHHKECYWRWHVNGYFRPKYCVLQWVGNMNGIDLMVIMKPAGIAFEFCGTGALSCLQWFHTGFDEIESGICCKRWRDRNSANSESFKEPVSYTTYEVNFHMPMSEQPDSTGCVWWWKIQQRLSTFQEVCAFEWPQEACKDIIMHYHTMVIKMFCWTQVLWPTGFREPTIKKAFQRNFCAAICFHMLIWSTCTVEKLMDYYYELMPYVKCCYQQYRIVQHEMYFTWQFLVMDRILPVGCRCCGQCLLCHKGGFNCDVDMARRGYPAIGYECGCGVMWKVERMQMTEYVHMFECLVISTHRSGTKRGYKAQPDSWKRCQWIKGRPAGGPSLQPGYFIRDMDHKTVNINRAISWRWIRALQFRQAEWETMINTMSDLNRSLFSANWVQISNEKAMHWYQECGVSAYPSDYPCKEWGAIYRANTELCKNSFREDSNDPDAQRPRMVETMFFFTHNDRACFKLIGFRHKAGATFWFTMARGWGHRNTRLKFYLTHMYADEAVTPDFLPAGFVHGHKCIDKCYYRFWCPMWWHYDGIFCWYVSWNIAKWSERVQMKYISHIIAFMDVDPYVGRMNVTVTVHYANSWNEVERVPHYTIKVRCHHTVRAWASSPKNEHKASYQPDNFPLKLKIIKTCWKGDYYYFEGGENARSFEGAWCPYTMTIISTRCWSNVSHYICTFHGFDMCNLFQFYK";

//        Dump.println(str1);
//        Dump.println(str2);
//
//        LinearSpaceAlignment align = new LinearSpaceAlignment(str1, str2);
//        align.setPenalty(5);
//
//        align.run(0, str1.length()-1, 0, str2.length()-1);
//
//        Dump.println(align.trackToString());

        GlobalAlignment align2 = new GlobalAlignment(str1, str2);
        align2.setPenalty(5).setScoringMatrix(GlobalAlignment.ScoryngMatrixType.BLOSUM62);
        align2.make();

//        Dump.println(align2.trackToString());
//        Dump.println(align2.getWeightMatrix());

        align2.track(str1.length()-1, str2.length()-1);

        Dump.println(align2.getWeightMatrix()[str1.length()][str2.length()]);
        Dump.println(StringUtils.join(align2.getResult1(), ""));
        Dump.println(StringUtils.join(align2.getResult2(), ""));

    }

}
